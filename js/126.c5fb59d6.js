"use strict";(self["webpackChunkidaas_admin"]=self["webpackChunkidaas_admin"]||[]).push([[126],{6837:function(e,t,n){n.d(t,{Pe:function(){return o},XP:function(){return i}});var l=n(3396),a=n(6534);const i=e=>{const t=e.reduce(((e,t)=>{let n=t.split("/"),i=n.pop()||"";return i&&(e[i]=n[0]?(0,l.Fl)((()=>a.Z.state[n[0]][i])):(0,l.Fl)((()=>a.Z.state[i]))),e}),{});return t},o=e=>{const t=e.reduce(((e,t)=>{let n=t,l=t.split("/").pop()||0;return l&&(e[l]=e=>a.Z.dispatch(n,e)),e}),{});return t}},7274:function(e,t,n){n.d(t,{A:function(){return l}});const l={inline:!0,rules:{},items:[{controlType:"input",keyName:"name",label:"关键字"}],btns:[{label:" ",eventName:"submit",text:"搜索",type:"primary"},{eventName:"reset",text:"重置",type:"primary"}]}},7862:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(4870),i=n(4386),o=n(508),r=(0,l.aZ)({__name:"addAndEditPublicModel",props:{value:Boolean,modelInfo:{reqired:!0,type:Object},modelType:{type:Number,default:1},modelOptions:{require:!0,type:Object},title:{type:String,default:"资源"}},emits:["update:modelValue","submitSuccss"],setup(e,{emit:t}){const n=e,{modelInfo:r}=(0,a.BK)(n);let s=(0,a.iH)();const d=()=>{s.value?.validate((e=>{console.log(e,"提交表单"),t("submitSuccss",e,n.modelType)}))},c=()=>{s.value.resetFields(),t("update:modelValue",!1)};return(t,n)=>((0,l.wg)(),(0,l.j4)(i.Z,(0,l.dG)(t.$attrs,{title:1!=e.modelType?`修改${e.title}`:`新增${e.title}`,onConfirmSubmit:d,onClosedModel:c}),{default:(0,l.w5)((()=>[(0,l.Wm)(o.Z,{ref_key:"formDOM",ref:s,options:e.modelOptions,formInfo:(0,a.SU)(r)},null,8,["options","formInfo"])])),_:1},16,["title"]))}});const s=r;var d=s},126:function(e,t,n){n.r(t),n.d(t,{default:function(){return q}});var l=n(4143),a=(n(7437),n(6355)),i=(n(3069),n(3209)),o=(n(6905),n(9971)),r=(n(1430),n(9007),n(5791)),s=(n(6809),n(3396)),d=n(7139),c=n(4870),u=n(508),p=n(7862),m=n(7178),y=n(2655),g=n(6837),f=n(7274);const v={inline:!1,rules:{clientId:{required:!0},clientName:{required:!0},secret:{required:!0},allowedGrantTypes:{type:"array",required:!0,trigger:"change"}},items:[{controlType:"input",keyName:"clientId",label:"clientId"},{controlType:"input",keyName:"clientName",label:"clientName"},{controlType:"input",keyName:"description",label:"Description"}]},b={class:"flex_space_between"},I=(0,s.Uk)("添加"),S={class:"container"},k={class:"container-body"},_={class:"container-content"},w={class:"content-table"},T=(0,s.Uk)("是"),C=(0,s.Uk)("否"),N=(0,s.Uk)("编辑 "),h=(0,s.Uk)("删除 "),U={class:"content-pagination"};var W=(0,s.aZ)({__name:"identityServerClient",setup(e){const t=["identity/grantTypes"],n=["identity/getIdentIdentityServerClientList","identity/editIdentIdentityServerClient","identity/addtIdentIdentityServerClient","identity/deleteIdentIdentityServerClient"],W=(0,g.Pe)(n),z=(0,g.XP)(t),q=(0,c.qj)({pageNo:1,limit:0,pageSize:10,total:0});let j=(0,c.qj)({name:""}),Z=(0,c.iH)([]),O=(0,c.iH)(!1),x=(0,c.iH)(1),H=(0,c.iH)({id:"",clientId:"",clientName:"",description:"",allowedGrantTypes:[]}),L=(0,c.iH)(),{items:$}=v,A={...v,items:[...$,{controlType:"select",keyName:"allowedGrantTypes",label:"grantType",multiple:!0,options:z.grantTypes}]};console.log(z.grantTypes,"字段");const G=()=>{let{pageNo:e,pageSize:t}=q;console.log(e,t,"页码"),R()},P=e=>{Object.keys(e).forEach((t=>{j[t]=e[t]})),q.pageNo=1,R()},R=()=>{const e={filter:j.name||null,pageIndex:q.pageNo,pageSize:q.pageSize};W.getIdentIdentityServerClientList(e).then((e=>{Z.value=e.data||[],q.total=e.totalCount,0===Z.value.length&&q.pageNo>1&&(q.pageNo--,R())}))},V=e=>{x.value=2,O.value=!0,L.value=e,setTimeout((()=>{H.value=Object.keys(H.value).reduce(((t,n)=>("allowedGrantTypes"===n&&Array.isArray(e[n])?t[n]=e[n].map((e=>e.grantType)):t[n]=e[n],t)),{}),console.log(H.value,"修改表单")}),0)},D=(e,t)=>{let n=(0,c.IU)(L.value),l=1===t?e:{...n,...e};console.log(l,"参数"),1===t&&delete l.id;const a=1===t?W.addtIdentIdentityServerClient:W.editIdentIdentityServerClient;a(l).then((e=>{(0,m.z8)({message:"操作成功",type:"success"}),O.value=!1,R()}))},F=e=>{y.T.confirm("是否要删除该identity资源？","提示",{type:"warning"}).then((()=>{W.deleteIdentIdentityServerClient({id:e}).then((()=>{(0,m.z8)({type:"success",message:"删除成功"}),R()}))})).catch((()=>({})))};return R(),(e,t)=>{const n=r.mi,m=i.$Y,y=o.Ks,g=i.eI,v=a.R,W=l.Kf;return(0,s.wg)(),(0,s.j4)(W,{class:"full_container"},{header:(0,s.w5)((()=>[(0,s._)("div",b,[(0,s._)("span",null,(0,d.zw)(e.$router.currentRoute.value.meta&&e.$router.currentRoute.value.meta.title||""),1),(0,s.Wm)(n,{type:"success",onClick:t[0]||(t[0]=e=>((0,c.dq)(O)?O.value=!0:O=!0,(0,c.dq)(x)?x.value=1:x=1))},{default:(0,s.w5)((()=>[I])),_:1})])])),default:(0,s.w5)((()=>[(0,s._)("div",S,[(0,s.Wm)(u.Z,{formInfo:(0,c.SU)(j),options:(0,c.SU)(f.A),onSubmit:P},null,8,["formInfo","options"]),(0,s._)("div",k,[(0,s._)("div",_,[(0,s._)("div",w,[(0,s.Wm)(g,{data:(0,c.SU)(Z)},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{prop:"clientId",label:"客户ID","align-items":"center"}),(0,s.Wm)(m,{prop:"clientName",label:"客户名称","align-items":"center"}),(0,s.Wm)(m,{label:"启用","align-items":"center"},{default:(0,s.w5)((e=>[e.row.enabled?((0,s.wg)(),(0,s.j4)(y,{key:0,type:"success"},{default:(0,s.w5)((()=>[T])),_:1})):((0,s.wg)(),(0,s.j4)(y,{key:1,type:"danger"},{default:(0,s.w5)((()=>[C])),_:1}))])),_:1}),(0,s.Wm)(m,{prop:"absoluteRefreshTokenLifetime",label:"absoluteRefreshTokenLifetime","align-items":"center"}),(0,s.Wm)(m,{prop:"description",label:"Description","align-items":"center"}),(0,s.Wm)(m,{prop:"accessTokenLifetime",label:"accessTokenLifetime","align-items":"center"}),(0,s.Wm)(m,{label:"操作",width:"180","align-items":"center"},{default:(0,s.w5)((e=>[(0,s.Wm)(n,{type:"primary",onClick:t=>V(e.row),text:""},{default:(0,s.w5)((()=>[N])),_:2},1032,["onClick"]),(0,s.Wm)(n,{type:"danger",onClick:t=>F(e.row.id),text:""},{default:(0,s.w5)((()=>[h])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),(0,s._)("div",U,[(0,s.Wm)(v,{class:"flex_all_center mt20","current-page":q.pageNo,"onUpdate:current-page":t[1]||(t[1]=e=>q.pageNo=e),"page-size":q.pageSize,"onUpdate:page-size":t[2]||(t[2]=e=>q.pageSize=e),background:"",layout:"sizes,prev, pager, next,total",total:q.total,onSizeChange:G,onCurrentChange:G},null,8,["current-page","page-size","total"])])])])]),(0,s.Wm)(p.Z,{modelValue:(0,c.SU)(O),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,c.dq)(O)?O.value=e:O=e),modelInfo:(0,c.SU)(H),modelType:(0,c.SU)(x),modelOptions:(0,c.SU)(A),onSubmitSuccss:D},null,8,["modelValue","modelInfo","modelType","modelOptions"])])),_:1})}}});const z=W;var q=z},3069:function(e,t,n){n(1758),n(3877)}}]);
//# sourceMappingURL=126.c5fb59d6.js.map